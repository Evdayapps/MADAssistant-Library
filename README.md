# MADAssistant-Library
Mobile Android Debugging Assistant  
Library for integration in applications.


## What is it
MADAssistant is an on-device solution for logging information from client apps, for diagnostics and auditing.</br> 
The main goal of this project is to enable audit and logging of app events for later analysis, without the need for desktop software.</br>
It achieves this by pairing with a companion app [https://play.google.com/store/apps/details?id=com.evdayapps.madassistant.repository] which serves as the repository for the logs.</br>
By collecting all the different logs, it aims to provide a clear track of events which aid resolution of any issues.</br>

### Companion App Screenshots
<img width="150" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123690291-d61c1200-d871-11eb-8b5f-98b8e19cb0b3.png"> <img width="150" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123690296-d7e5d580-d871-11eb-847c-cb4920aca976.png"> <img width="150" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123690302-d9170280-d871-11eb-8a6e-c8ce1c766478.png"> <img width="150" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123690309-da482f80-d871-11eb-923e-eea441e91615.png"> <img width="150" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123690315-dae0c600-d871-11eb-85b9-4d2271b14682.png"> <img width="150" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123690320-db795c80-d871-11eb-97c1-14d01275fdb6.png">



## What can it log
The library currently provides logging for the following types of events:
- Network Logs
- Analytics Calls
- Exceptions and Crashes
- Generics Logs


## Who does it benefit
The library aims to provide utility to users across the SDLC, from developers to end-users.
- Quality Assurance - By integrating it into test builds, it can serve as a log of every session, and log any crashes that might occur.
- Product Owners - Logging of analytics events help in auditing builds for proper implementation of analytics events
- Developers - Varies utility with all the different logs
- End Users - This library can even be integrated into production builds, to enable debugging of issues on a client's device



## Security
In order to receive logs, the user has to first share an encrypted authToken, generated by the developer.</br>
This authToken encapsulates the following information:
- The user's installation identifier (a uuid generated by the MADAssistant app once per installation)
- An optional start and end time
- The logs accessible to the user (with fine-grained regex-based filters)

<img width="200" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123684638-5723db00-d86b-11eb-818e-5b39c1640bd7.png"> <img width="200" alt="portfolio_view" src="https://user-images.githubusercontent.com/3502209/123684642-58ed9e80-d86b-11eb-9393-f817ce6ad96f.png"></br>

All this information needs to be encrypted using the same passphrase, which is then decrypted by the library upon receipt.</br>
Logs are filtered client-side before transmission to the MADAssistant app.


## What exactly is logged
As stated earlier, the logs are:
- Network Calls
- Analytics Events
- Exceptions and Crash reports
- General Android android.util.Log logs


### Network Logs
Properties:
- **Request** - Headers, Connection settings, Method, Timestamp, Body
- **Response** - Headers, Body, Status, Sizes, Timestamp
- **Exception** - (if any)

Filters:
- **Method** - regex string
- **Url** - regex string

### Analytics
Properties:
- **Destination** - Name of the analytics service
- **Event Name** - Name of the event
- **Parameters** - The payload for the event

Filters:
- **Destination Name** - (Regex) Name of the destination
- **Event Name** - (Regex) Name of the event
- **Parameters** - (Regex) The parameters, as a json string

### Exceptions and Crashes
Crashes can be auto logged by calling the connectExceptionHandler method
Properties:
- **Thread Name** - The name of the thread on which it occured
- **Type** - The type of the exception
- **Message** - An optional message that can be provided
- **Stacktrace** - The stack trace for the exception/crash, with causes

Filters:
- **Type** - (Regex) 
- **Message** - (Regex) 

### Generic Logs
Can be used for general logging.  
Supports all log types as per android.utils.Log

Properties:
- **Type** - The type of the log, matching android.utils.Log
- **Tag** - Tag, similar to the tag in Log.i(..), Log.d(..), etc
- **Message**- The message to log
- **Data** - An optional map of String to Any for logging any additional information required

Filters:
- **Type** - Set of options on what type of logs to allow (Debug, Info, Verbose, Warning, Error)
- **Tag** - (Regex)
- **Message** - (Regex)



## Integration into your application
- Add the jitpack repository to project build.gradle
  ```
  allprojects {
	repositories {
		...
		maven { url 'https://jitpack.io' }
	}
  }
  ```
- Add the library as a dependency
  ```
  implementation 'com.github.Evdayapps.MADAssistant-Library:madassistant-clientlib:0.0.7'
  // This is required to utilise an OkHttp Interceptor that will log network calls
  implementation 'com.github.Evdayapps.MADAssistant-Library:madassistant-adapter-okhttp3-3:0.0.7'
  ```
- Create an instance of MADAssistantClient
  ```
  val client = MADAssistantClientImpl(
    applicationContext = context,
    passphrase = "<your passphrase here>",
    logUtils = object : com.evdayapps.madassistant.clientlib.utils.LogUtils {
        // This is optional. Use it if you wish to view logs from the library
	override fun d(tag: String, message: String) = Log.d(tag, message)
	override fun e(throwable: Throwable) = throwable.printStackTrace()
	override fun i(tag: String, message: String) = Log.i(tag, message)
    }
  )
  ```
- Initialise the client
  ```
  client.bindToService()
  ```
- Log events using the appropriate method
  ```
  // For Exceptions
  fun logException(throwable: Throwable)
  
  // For Analytics
  fun logAnalyticsEvent(destination: String, eventName: String, data: Map<String, Any?>)
  
  // For logs that match android.util.Log
  fun logGenericLog(type: Int, tag: String, message: String, data: Map<String, Any?>?)

  // For network logs. Alternately [MADAssistantOkHttp3Interceptor] can be used for okhttp setups
  fun logNetworkCall(data: NetworkCallLogModel)
  ```
- Logging Crashes
  ```
  client.logCrashes()
  ```
  Alternately, crashes can be logged manually too using:
  ```
  client.logCrashReport(throwable: Throwable)
  ```
 










